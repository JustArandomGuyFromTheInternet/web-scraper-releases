<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Web Scraper - Social Media Intelligence</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" href="ICON-modified.png" type="image/png">
    <script defer src="renderer.js"></script>
    <style>
        #license-timer {
            position: fixed;
            top: 10px;
            left: 10px;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 13px;
            z-index: 1000;
            font-weight: bold;
            display: none;
        }

        #license-timer.trial {
            background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }

        #license-timer.pro {
            background: linear-gradient(135deg, #10B981 0%, #059669 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        #license-timer.expired {
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }
    </style>
</head>

<body>
    <div id="license-timer"></div>
    <div class="container">
        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                <div style="flex: 1; text-align: center;">
                    <img id="appIcon" src="ICON-modified.png" alt="Web Scraper Logo"
                        style="width: 64px; height: 64px; margin-bottom: 10px; border-radius: 8px; display: block; margin-left: auto; margin-right: auto;">
                    <h1>Web Scraper</h1>
                    <p>Extract and analyze social media content</p>
                </div>
                <button class="btn btn-settings" id="settingsBtn" title="Settings">‚öôÔ∏è</button>
            </div>
        </div>

        <!-- Settings Modal (New Design) -->
        <div id="settingsModal" class="modal" style="display: none;">
            <div class="modal-content">

                <!-- Header -->
                <div class="modal-header">
                    <h2>Settings</h2>
                    <button class="close-btn" id="closeSettingsBtn">&times;</button>
                </div>

                <!-- Body -->
                <div class="modal-body">

                    <!-- API Configuration Section -->
                    <div class="settings-section">
                        <div class="section-title">API Configuration</div>
                        <div class="form-group">
                            <label class="form-label">Google Gemini API Key</label>
                            <input type="password" class="form-input" id="apiKeyInput"
                                placeholder="Enter your Gemini API Key">
                            <div class="form-hint">Required for AI vision analysis. Get your key at ai.google.dev</div>
                            <div id="apiKeyStatus" class="status-badge status-disconnected" style="margin-top: 8px;">Not
                                Configured</div>
                        </div>
                    </div>

                    <!-- Column Selection Section -->
                    <div class="settings-section">
                        <div class="section-title">Output Configuration</div>
                        <p style="font-size: 13px; color: #64748b; margin-bottom: 12px; line-height: 1.4;">
                            Choose which data fields to extract and save during <strong>future</strong> scraping
                            sessions. Unchecked items will be skipped to save time.
                        </p>
                        <div class="form-group">
                            <div class="checkbox-group"
                                style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                <label class="checkbox-label"><input type="checkbox" id="colSender" checked> Sender
                                    Name</label>
                                <label class="checkbox-label"><input type="checkbox" id="colGroup" checked> Group
                                    Name</label>
                                <label class="checkbox-label"><input type="checkbox" id="colDate" checked> Post
                                    Date</label>
                                <label class="checkbox-label"><input type="checkbox" id="colContent" checked>
                                    Content</label>
                                <label class="checkbox-label"><input type="checkbox" id="colSummary" checked>
                                    Summary</label>
                                <label class="checkbox-label"><input type="checkbox" id="colLikes" checked>
                                    Likes</label>
                                <label class="checkbox-label"><input type="checkbox" id="colComments" checked>
                                    Comments</label>
                            </div>
                        </div>
                    </div>

                    <div class="divider" style="height: 1px; background: #e2e8f0; margin: 32px 0;"></div>

                    <!-- Repair Tools Section -->
                    <div class="settings-section">
                        <div class="section-title">Data Repair Tools</div>
                        <p style="font-size: 13px; color: #64748b; margin-bottom: 12px; line-height: 1.4;">
                            Fix missing data in your <strong>existing</strong> spreadsheet. These tools scan empty cells
                            in your sheet and attempt to retrieve the missing information retroactively.
                        </p>

                        <div class="repair-tools-grid"
                            style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <button id="repairGroupsBtn" class="btn btn-secondary" style="font-size: 0.9em;">
                                üîß Group Names
                            </button>
                            <button id="repairLikesBtn" class="btn btn-secondary" style="font-size: 0.9em;">
                                üëç Likes
                            </button>
                            <button id="repairCommentsBtn" class="btn btn-secondary" style="font-size: 0.9em;">
                                üí¨ Comments
                            </button>
                            <button id="repairContentBtn" class="btn btn-secondary" style="font-size: 0.9em;">
                                üìù Content/Summary
                            </button>
                            <button id="repairSenderBtn" class="btn btn-secondary" style="font-size: 0.9em;">
                                üë§ Sender Name
                            </button>
                            <button id="repairDateBtn" class="btn btn-secondary" style="font-size: 0.9em;">
                                üìÖ Post Date
                            </button>
                            <button id="repairAllBtn" class="btn btn-primary"
                                style="grid-column: 1 / -1; margin-top: 8px;">
                                üîÑ Repair All Missing Data
                            </button>
                        </div>
                        <div id="repairStatus"
                            style="margin-top: 10px; font-size: 0.9em; color: #666; min-height: 20px;"></div>
                    </div>

                    <!-- System Updates Section -->
                    <div class="settings-section">
                        <div class="section-title">System Updates</div>
                        <div class="update-info" id="updateInfoWrapper"
                            style="display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: #f0f9ff; border: 1px solid #bae6fd; border-radius: 6px; margin-bottom: 12px;">
                            <span class="status-badge up-to-date"
                                style="background: #dbeafe; color: #1e40af; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: 600;">Current</span>
                            <span class="update-status"
                                style="font-size: 13px; color: #0369a1; font-weight: 500;">Version ...</span>
                        </div>
                        <div class="btn-group">
                            <button class="btn btn-secondary" id="checkUpdateBtn" style="width: 100%;">
                                Check for Updates
                            </button>
                        </div>
                        <div id="updateStatus" style="margin-top: 8px; text-align: center; font-size: 13px;"></div>
                    </div>

                </div>

                <!-- Footer -->
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancelSettingsBtn">Cancel</button>
                    <button class="btn btn-primary" id="saveSettingsBtn">Save Changes</button>
                </div>
            </div>
        </div>

        <div class="content">
            <!-- 1. Authentication -->
            <div class="section auth-section">
                <div class="section-header">
                    <h3>üîê Authentication</h3>
                    <span id="authStatus" class="status-badge status-disconnected">Not connected</span>
                </div>
                <div class="auth-buttons">
                    <button type="button" id="loginBtn" class="btn btn-primary">Connect to Google</button>
                    <button type="button" id="logoutBtn" class="btn btn-secondary"
                        style="display: none;">Disconnect</button>
                    <button class="btn btn-outline" id="openBrowserBtn"
                        title="Open browser to connect Facebook and Instagram accounts">üåê Open Browser</button>
                </div>
                <div class="info-tip" style="font-size: 12px; margin-top: 8px;">
                    üí° "Open Browser" button - to connect Facebook and Instagram accounts
                </div>
                <div class="info-tip">
                    üí° Connect once and get access to all your spreadsheets
                </div>
            </div>

            <!-- 2. Links Input -->
            <div class="section input-section">
                <div class="section-header">
                    <h3>üìã Links to Scrape</h3>
                </div>
                <div class="form-group">
                    <textarea id="linksInput" placeholder="Paste links here - one link per line..."></textarea>
                </div>
                <div id="linksStatus"></div>
            </div>

            <!-- 3. Save Destination -->
            <div class="section destination-section">
                <div class="section-header">
                    <h3>üíæ Save Destination</h3>
                </div>
                <div class="tabs">
                    <button class="tab active" data-target="csv">Local Excel</button>
                    <button class="tab" data-target="sheets">Google Sheets</button>
                </div>

                <!-- Excel Tab -->
                <div class="tab-content active" id="csv-content">
                    <div class="form-group">
                        <label>Folder Path</label>
                        <div class="input-group">
                            <input type="text" id="savePath" value="./out_new" placeholder="Select folder">
                            <button class="btn btn-icon" id="browseSavePathBtn">üìÅ</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>File Name</label>
                        <input type="text" id="fileName" readonly>
                    </div>
                    <div class="form-group">
                        <label>Or select existing file</label>
                        <div class="input-group">
                            <input type="text" id="existingFile" placeholder="Select existing Excel file" readonly>
                            <button class="btn btn-icon" id="browseFileBtn">üìÅ</button>
                        </div>
                    </div>
                </div>

                <!-- Sheets Tab -->
                <div class="tab-content" id="sheets-content">
                    <div class="form-group">
                        <label>Sheet URL</label>
                        <div class="input-group">
                            <input type="text" id="sheetsUrl" placeholder="https://docs.google.com/spreadsheets/d/...">
                            <button class="btn btn-outline btn-sm" id="testConnectionBtn">Test</button>
                        </div>
                        <span id="sheetsStatus" class="status-badge status-disconnected"
                            style="margin-top: 8px; display: inline-flex;">Not connected</span>
                    </div>
                    <div class="form-group">
                        <label>Sheet Name</label>
                        <input type="text" id="sheetName" value="Summaries" placeholder="Summaries">
                    </div>
                    <div class="checkbox-inline">
                        <input type="checkbox" id="smartTableSync" checked>
                        <label for="smartTableSync">Smart column matching</label>
                    </div>
                </div>
            </div>

            <!-- 4. Start Button -->
            <div class="section action-section">
                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button id="visualBtn" class="btn visual">üöÄ START SCRAPING</button>
                    <button id="stopBtn" class="btn btn-danger" disabled>‚èπ Stop</button>
                </div>
                <div class="progress-container" id="progressContainer" style="display: none;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px;">
                        <span id="progressText">Processing...</span>
                        <span id="progressPercent" style="color: var(--primary); font-weight: 600;">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- 5. Log -->
            <div class="section log-section">
                <div class="section-header">
                    <h3>üìä Activity Log</h3>
                    <div class="log-actions">
                        <button class="btn btn-sm btn-outline" id="clearLogBtn">üóëÔ∏è Clear</button>
                        <button class="btn btn-sm btn-outline" id="copyLogBtn">üìã Copy</button>
                        <button class="btn btn-sm btn-outline" id="deleteScreenshotsBtn">üóëÔ∏è Delete Screenshots</button>
                        <button class="btn btn-sm btn-outline" id="openScreenshotsFolderBtn">üìÇ Open Folder</button>
                    </div>
                </div>
                <div class="log-viewer" id="logViewer">
                    <div class="log-entry log-info">System ready</div>
                </div>
            </div>
        </div>
    </div>
</body>
<style>
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        align-items: center;
        justify-content: center;
    }

    .modal-content {
        background-color: white;
        border-radius: 12px;
        width: 90%;
        max-width: 500px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    .modal-header {
        padding: 20px;
        border-bottom: 1px solid #e0e0e0;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .modal-header h2 {
        margin: 0;
        font-size: 20px;
    }

    .btn-close {
        background: none;
        border: none;
        font-size: 28px;
        cursor: pointer;
        color: #666;
        padding: 0;
        width: 30px;
        height: 30px;
        line-height: 1;
    }

    .btn-close:hover {
        color: #000;
    }

    .modal-body {
        padding: 20px;
    }

    .modal-footer {
        padding: 20px;
        border-top: 1px solid #e0e0e0;
        display: flex;
        justify-content: flex-end;
        gap: 10px;
    }
</style>
</body>

</html>